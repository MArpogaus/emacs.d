#+TITLE: Emacs Literate Configuration
#+AUTHOR: Marcel Arpogaus
#+PROPERTY: header-args :tangle yes
#+STARTUP: show2levels
#+auto_tangle: t

* Configuration

** Table of Contents                                               :TOC_3_gh:
- [[#configuration][Configuration]]
  - [[#references][References]]
  - [[#conventional-headers-for-emacs-libraries][Conventional Headers for Emacs Libraries]]
  - [[#to-dos][To-dos]]
  - [[#notes][Notes]]
    - [[#add-git-url-to-pkg-headlines][Add git url to pkg headlines]]
  - [[#emacs-initialization][Emacs Initialization]]
    - [[#package-management][Package Management]]
    - [[#benchmark-startup][Benchmark startup]]
    - [[#personal-information][Personal Information]]
    - [[#paths][Paths]]
    - [[#better-defaults][Better Defaults]]
    - [[#keymaps][Keymaps]]
  - [[#configure-packages][Configure Packages]]
    - [[#ui][UI]]
    - [[#ux][UX]]
    - [[#org][Org]]
    - [[#tools][Tools]]
    - [[#completion][Completion]]
    - [[#version-control][Version Control]]
    - [[#project-management][Project Management]]
    - [[#programming][Programming]]
    - [[#keybindings][Keybindings]]
  - [[#conventional-library-footer][Conventional Library Footer]]

** References
This Emacs literate configuration has been inspired by the following projects:

- [[https://config.daviwil.com/emacs][Emacs Configuration - config.daviwil.com]]
- [[https://github.com/gilbertw1/emacs-literate-starter/blob/master/emacs.org][emacs-literate-starter/emacs.org at master · gilbertw1/emacs-literate-starter...]]
- [[https://github.com/doomemacs/doomemacs][GitHub - doomemacs/doomemacs: An Emacs framework for the stubborn martian hacker]]
- [[https://github.com/rougier/dotemacs][GitHub - rougier/dotemacs: Litterate configuration for GNU Emacs]]
- [[https://github.com/SystemCrafters/crafted-emacs][GitHub - SystemCrafters/crafted-emacs: A sensible base Emacs configuration.]]
- [[https://github.com/terlar/emacs-config][GitHub - terlar/emacs-config: Emacs configuration]]
- [[https://github.com/zoliky/dotemacs][GitHub - zoliky/dotemacs: My GNU Emacs configuration.]]
- [[https://panadestein.github.io/emacsd][Pandenstein - Emacs literate configuration]]
- [[https://systemcrafters.net/emacs-from-scratch/the-best-default-settings/][The 6 Emacs Settings Every User Should Consider - System Crafters]]

** Conventional Headers for Emacs Libraries
[[https://www.gnu.org/software/emacs/manual/html_node/elisp/Library-Headers.html][Library Headers (GNU Emacs Lisp Reference Manual)]]
#+begin_src emacs-lisp
    ;;; emacs.el --- Emacs configuration  -*- lexical-binding: t; -*-
  ;; This file has been generated from emacs.org file. DO NOT EDIT.

  ;; Copyright (C) 2010-2021 Marcel Arpogaus

  ;; Author: Marcel Arpogaus
  ;; Keywords: internal
  ;; URL: https://github.com/MArpogaus/emacs.d/

  ;; This file is not part of GNU Emacs.
#+end_src
** To-dos :noexport_1:
*** TODO Add debugger
- [[https://github.com/emacs-lsp/dap-mode][GitHub - emacs-lsp/dap-mode: Emacs Debug Adapter Protocol]]
- [[https://emacs-lsp.github.io/dap-mode/page/python-poetry-pyenv/][Python, debbuging with poetry + pyenv - DAP Mode]]

*** TODO Add iPython shell command
*** TODO Add doom snippets?
- [[https://github.com/ptn/doom-snippets][GitHub - ptn/doom-snippets: The Doom Emacs snippets library]]
*** TODO anzu
https://github.com/emacsorphanage/anzu
** Notes
*** Add git url to pkg headlines
#+begin_src bash
  for p in $(grep -P '^\*\*\*\* ([a-z\-])*$' emacs.org | cut -d ' ' -f 2); do
      url=$(git -C ~/.emacs.d/straight/repos/*$p* remote get-url origin)
      if [ $? -eq 0 ]; then
          sed "s|\*\*\*\* $p|**** [[$url][$p]]|" -i emacs.org
      fi;
  done
#+end_src

** Emacs Initialization
*** Package Management
**** Install and configure use-package

Lets install and configure =use-package= and use =straight= as the underlying package manager.
We also load =bind-key= here which is used by =use-package= for keybindings.

#+begin_src emacs-lisp
  (when (< emacs-major-version 29)
    (straight-use-package 'use-package)
    (use-package bind-key))

  (setq straight-use-package-by-default t
        use-package-always-defer t)
  ;; make use-package more verbose when ´‘--debug-init´ is passed
  ;; https://www.gnu.org/software/emacs/manual/html_node/use-package/Troubleshooting.html
  (when init-file-debug
    (setq use-package-verbose t
          use-package-expand-minimally nil
          use-package-compute-statistics t
          debug-on-error t))
#+end_src

*** Benchmark startup
#+begin_src emacs-lisp :tangle no
  (use-package benchmark-init
    :demand t
    ;; To disable collection of benchmark data after init is done.
    :hook (after-init . benchmark-init/deactivate))
#+end_src

*** Personal Information
Let's set some variables with basic user information.

#+begin_src emacs-lisp
  (setq user-full-name "Marcel Arpogaus"
        user-mail-address "znepry.necbtnhf@tznvy.pbz")
#+end_src

*** Paths
Use no-littering to automatically set common paths to the new user-emacs-directory =~/.cache/emacs=..
#+begin_src emacs-lisp
  (use-package no-littering
    :demand t
    :init
    (setq org-directory (expand-file-name "Notes/org/" (getenv "HOME"))
          org-cite-global-bibliography (file-expand-wildcards (expand-file-name "bib/*.bib" org-directory))
          org-brain-path (expand-file-name "brain/" org-directory)
          my/templates-path (expand-file-name "templates.eld" user-emacs-directory)
          ;; Since init.el will be generated from this file, we save customization in a dedicated file.
          custom-file (expand-file-name "custom.el" user-emacs-directory))

    ;; Change the user-emacs-directory to keep unwanted things out of ~/.emacs.d
    (setq user-emacs-directory (expand-file-name "~/.cache/emacs/")
          url-history-file (expand-file-name "url/history" user-emacs-directory)))
#+end_src
*** Better Defaults
#+begin_src emacs-lisp
  (use-package emacs
    :custom
    ;; Startup
    ;; Emacs does a lot of things at startup and here, we disable pretty much everything.
    (inhibit-startup-screen t)			 ; Disable start-up screen
    (inhibit-startup-message t)			 ; Disable startup message
    (inhibit-startup-echo-area-message t)	 ; Disable initial echo message
    (initial-scratch-message "")		 ; Empty the initial *scratch* buffer

    ;; Encoding
    ;; We tell emacs to use UTF-8 encoding as much as possible.
    (set-default-coding-systems 'utf-8)		 ; Default to utf-8 encoding
    (prefer-coding-system       'utf-8)		 ; Add utf-8 at the front for automatic detection.
    (set-terminal-coding-system 'utf-8)		 ; Set coding system of terminal output
    (set-keyboard-coding-system 'utf-8)		 ; Set coding system for keyboard input on TERMINAL
    (set-language-environment "English")	 ; Set up multilingual environment

    ;; Recovery
    ;; If Emacs or the computer crashes, you can recover the files you were editing at the time of the crash from their auto-save files. To do this, start Emacs again and type the command ~M-x recover-session~. Here, we parameterize how files are saved in the background.
    (auto-save-default t)			 ; Auto-save every buffer that visits a file
    (auto-save-timeout 20)			 ; Number of seconds between auto-save
    (auto-save-interval 200)			 ; Number of keystrokes between auto-saves

    ;; Text
    ;; Pretty self-explanatory
    (use-short-answers t)			 ; Replace yes/no prompts with y/n
    (confirm-nonexistent-file-or-buffer nil)	 ; Ok to visit non existent files

    ;; Mouse
    ;; Mouse behavior can be finely controlled using mouse-avoidance-mode.
    (mouse-yank-at-point t)			 ; Yank at point rather than pointer
    (mouse-avoidance-mode 'exile)		 ; Avoid collision of mouse with point
    ;; Mouse active in tty mode.
    (xterm-mouse-mode (display-graphic-p))

    ;; Scroll
    ;; Smoother scrolling.
    (scroll-conservatively 101)                  ; Avoid recentering when scrolling far
    (scroll-margin 2)                            ; Add a margin when scrolling vertically
    (recenter-positions '(5 bottom))             ; Set re-centering positions

    ;; Cursor
    ;; We set the appearance of the cursor: horizontal line, 2 pixels thick, no blinking
    (cursor-in-non-selected-windows nil)	 ; Hide the cursor in inactive windows
    (cursor-type '(hbar . 2))			 ; Underline-shaped cursor
    (cursor-intangible-mode t)			 ; Enforce cursor intangibility
    (x-stretch-cursor nil)			 ; Don't stretch cursor to the glyph width
    (blink-cursor-mode nil)			 ; Still cursor

    ;; Typography
    (fill-column 80)				 ; Default line width
    (sentence-end-double-space nil)		 ; Use a single space after dots
    (bidi-paragraph-direction 'left-to-right)	 ; Faster
    (truncate-string-ellipsis "…")		 ; Nicer ellipsis

    ;; Default mode
    ;; Default & initial mode is text.
    (initial-major-mode 'text-mode)		 ; Initial mode is text
    (default-major-mode 'text-mode)		 ; Default mode is text

    ;; Tabulations
    ;; No tabulation, ever.
    (indent-tabs-mode nil)			 ; Stop using tabs to indent
    (tab-width 4)				 ; Smaller width for tab characters

    ;; Don't pop up UI dialogs when prompting
    (use-dialog-box nil)
    (use-file-dialog nil)

    ;; disable native compiler warnings
    (native-comp-async-report-warnings-errors nil)

    ;; DOOM: add some space between fringe it and buffer.
    (fringes-outside-margins t)

    :preface
    ;; History
    ;; Remove text properties for kill ring entries (see https://emacs.stackexchange.com/questions/4187). This saves a lot of time when loading it.
    (defun unpropertize-kill-ring ()
      (setq kill-ring (mapcar 'substring-no-properties kill-ring)))

    :config
    ;; Load customization File
    (load custom-file 'noerror 'nomessage)

    :bind
    ;;ESC Cancels All
    (("<escape>" . keyboard-escape-quit))

    :hook
    ;; Enable word wrapping
    (((prog-mode conf-mode text-mode) . visual-line-mode)
     ;; display column number in modeline
     ((prog-mode conf-mode) . column-number-mode)
     (kill-emacs . unpropertize-kill-ring)))
#+end_src

*** Keymaps

This section initializes various keymaps used for different purposes.

#+begin_src emacs-lisp
  ;; setup keymaps
  (use-package emacs
    :preface
    (defvar my/leader-map (make-sparse-keymap) "key-map for leader key")
    (defvar my/version-control-map (make-sparse-keymap) "key-map for version control commands")
    (defvar my/git-gutter-repeat-map (make-sparse-keymap) "key-map for GitGutter commands")
    (defvar my/completion-map (make-sparse-keymap) "key-map for completion commands")
    (defvar my/buffer-map (make-sparse-keymap) "key-map for buffer commands")
    (defvar my/buffer-scale-map (make-sparse-keymap) "key-map for buffer text scale commands")
    (defvar my/window-map (make-sparse-keymap) "key-map for window commands")
    (defvar my/file-map (make-sparse-keymap) "key-map for file commands")
    (defvar my/workspace-map (make-sparse-keymap) "key-map for workspace commands")
    (defvar my/toggle-map (make-sparse-keymap) "key-map for toggle commands")
    (defvar my/open-map (make-sparse-keymap) "key-map for open commands")

    :config
    ;; remove keybind for suspend-frame
    (global-unset-key (kbd "C-z"))

    ;; version control commands
    (define-key my/leader-map "v" (cons "version-control" my/version-control-map))
    (define-key my/version-control-map "g" (cons "gutter" my/git-gutter-repeat-map))

    ;; completion commands
    (define-key my/leader-map "." (cons "completion" my/completion-map))

    ;; file, buffer, window and workspace commands
    (define-key my/leader-map "b" (cons "buffer" my/buffer-map))
    (define-key my/buffer-map "z" (cons "scale" my/buffer-scale-map))
    (define-key my/leader-map "w" (cons "window" my/window-map))
    (define-key my/leader-map "f" (cons "file" my/file-map))
    (define-key project-prefix-map "w" (cons "workspace" my/workspace-map))

    ;; toggle commands
    (define-key my/leader-map "t" (cons "toggle" my/toggle-map))

    ;; opening recent files ne buffer frame etc
    (define-key my/leader-map "o" (cons "open" my/open-map))

    ;; add predefined maps to leader map
    (define-key my/leader-map "g" (cons "goto" goto-map))
    (define-key my/leader-map "h" (cons "help" help-map))
    (define-key my/leader-map "p" (cons "project" project-prefix-map))
    (define-key my/leader-map "s" (cons "search" search-map))
    ;;    (define-key my/leader-map "x" (cons "C-x" ctl-x-map))

    :bind
    (:map my/buffer-map
          ("e" . eval-buffer)
          ("k" . kill-this-buffer)
          ("K" . kill-buffer)
          ("c" . clone-buffer)
          ("r" . revert-buffer)
          ("e" . eval-buffer)
          ("s" . save-buffer)
          :map my/file-map
          ("f" . find-file)
          ("F" . find-file-other-window)
          ("d" . find-dired)
          ("c" . copy-file)
          ("f" . find-file)
          ("d" . delete-file)
          ("r" . rename-file)
          ("w" . write-file)
          :map my/open-map
          ("F" . make-frame)
          ("i" . ielm)
          ("e" . eshell)
          ("t" . term)
          ("s" . scratch-buffer)
          :repeat-map my/buffer-scale-map
          ("+" . text-scale-increase)
          ("-" . text-scale-decrease)
          ("=" . text-scale-adjust)
          :repeat-map my/window-map
          ("n" . next-window-any-frame)
          ("p" . previous-window-any-frame)
          ("k" . delete-window)
          ("K" . kill-buffer-and-window)
          ("+" . enlarge-window)
          ("-" . shrink-window)
          ("*" . enlarge-window-horizontally)
          ("’" . shrink-window-horizontally)
          :exit
          ("=" . balance-windows)
          ("r" . split-window-right)
          ("b" . split-window-below)
          ("v" . split-window-vertically)
          ("h" . split-window-horizontally)
          ("m" . delete-other-windows)
          ("m" . delete-other-windows)
          ("M" . delete-other-windows-vertically)))
#+end_src

** Configure Packages
*** UI
**** [[https://github.com/emacs-straight/ascii-art-to-unicode.git][ascii-art-to-unicode]]
Make org-brain-visualize-mode look a bit nicer.
#+begin_src emacs-lisp
  (use-package ascii-art-to-unicode
    :after org-brain
    :preface
    (defface aa2u-face '((t . nil))
      "Face for aa2u box drawing characters")
    (defun aa2u-org-brain-buffer ()
      (let ((inhibit-read-only t))
        (make-local-variable 'face-remapping-alist)
        (add-to-list 'face-remapping-alist
                     '(aa2u-face . org-brain-wires))
        (ignore-errors (aa2u (point-min) (point-max)))))
    :config
    (advice-add #'aa2u-1c :filter-return
                (lambda (str) (propertize str 'face 'aa2u-face)))
    :hook
    (org-brain-after-visualize . aa2u-org-brain-buffer))
#+end_src

**** [[https://github.com/emacs-dashboard/emacs-dashboard.git][dashboard]]
#+begin_src emacs-lisp
  (use-package dashboard
    :custom
    ;; Content is not centered by default. To center, set
    (dashboard-center-content t)

    ;; display an alternative emacs logo
    (dashboard-startup-banner 'logo)

    ;; To disable shortcut "jump" indicators for each section, set
    (dashboard-show-shortcuts nil)
    (dashboard-projects-backend 'project-el)
    (dashboard-items '((recents  . 10)
                       (projects . 10)))
    (dashboard-icon-type 'nerd-icons) ;; use `nerd-icons' package
    (dashboard-display-icons-p (display-graphic-p))
    (dashboard-set-heading-icons (display-graphic-p))
    (dashboard-set-file-icons (display-graphic-p))
    (dashboard-set-navigator t) ;; show navigator below the banner:
    (dashboard-set-footer nil) ;; disable footer
    :hook
    (after-init . dashboard-setup-startup-hook))
#+end_src
**** display-line-numbers :build_in:
Enable line numbers for some modes
#+begin_src emacs-lisp
  (use-package display-line-numbers
    :hook
    (((prog-mode conf-mode text-mode) . display-line-numbers-mode)
     ;; disable for org mode
     (org-mode . (lambda () (display-line-numbers-mode 0)))))
#+end_src

**** [[https://github.com/seagle0128/doom-modeline.git][doom-modeline]]
A fancy and fast mode-line inspired by minimalism design.
#+begin_src emacs-lisp
  (use-package doom-modeline
    :custom
    ;; If non-nil, cause imenu to see `doom-modeline' declarations.
    ;; This is done by adjusting `lisp-imenu-generic-expression' to
    ;; include support for finding `doom-modeline-def-*' forms.
    ;; Must be set before loading doom-modeline.
    (doom-modeline-support-imenu t)

    ;; How tall the mode-line should be. It's only respected in GUI.
    ;; If the actual char height is larger, it respects the actual height.
    (doom-modeline-height 20)

    ;; display the real names, please put this into your init file.
    (find-file-visit-truename t)

    ;; Whether to use hud instead of default bar. It's only respected in GUI.
    (doom-modeline-hud t)

    ;; Determines the style used by `doom-modeline-buffer-file-name'.
    ;;
    ;; Given ~/Projects/FOSS/emacs/lisp/comint.el
    ;;   auto => emacs/l/comint.el (in a project) or comint.el
    ;;   truncate-upto-project => ~/P/F/emacs/lisp/comint.el
    ;;   truncate-from-project => ~/Projects/FOSS/emacs/l/comint.el
    ;;   truncate-with-project => emacs/l/comint.el
    ;;   truncate-except-project => ~/P/F/emacs/l/comint.el
    ;;   truncate-upto-root => ~/P/F/e/lisp/comint.el
    ;;   truncate-all => ~/P/F/e/l/comint.el
    ;;   truncate-nil => ~/Projects/FOSS/emacs/lisp/comint.el
    ;;   relative-from-project => emacs/lisp/comint.el
    ;;   relative-to-project => lisp/comint.el
    ;;   file-name => comint.el
    ;;   buffer-name => comint.el<2> (uniquify buffer name)
    ;;
    ;; If you are experiencing the laggy issue, especially while editing remote files
    ;; with tramp, please try `file-name' style.
    ;; Please refer to https://github.com/bbatsov/projectile/issues/657.
    (doom-modeline-buffer-file-name-style 'relative-to-project)

    ;; Whether display icons in the mode-line.
    ;; While using the server mode in GUI, should set the value explicitly.
    (doom-modeline-icon (display-graphic-p))

    ;; If non-nil, only display one number for checker information if applicable.
    (doom-modeline-checker-simple-format t)

    :hook
    (after-init . doom-modeline-mode))
#+end_src

**** hl-line :build_in:

Highlighting of the current line (native mode)

#+begin_src emacs-lisp
  (use-package hl-line
    :hook
    ((prog-mode org-mode) . global-hl-line-mode))
#+end_src

**** [[https://github.com/mickeynp/ligature.el.git][ligature]]
#+begin_src emacs-lisp
  (use-package ligature
    :config
    ;; set Fira as default font
    (set-frame-font "Fira Code-10" nil t)
    :preface
    (defun my/setup-ligatures ()
      ;; Enable the "www" ligature in every possible major mode
      (ligature-set-ligatures 't '("www"))
      ;; Enable traditional ligature support in eww-mode, if the
      ;; `variable-pitch' face supports it
      (ligature-set-ligatures '(eww-mode org-mode) '("ff" "fi" "ffi"))
      ;; Enable all Cascadia and Fira Code ligatures in programming modes
      (ligature-set-ligatures '(prog-mode org-mode)
                              '(;; == === ==== => =| =>>=>=|=>==>> ==< =/=//=// =~
                                ;; =:= =!=
                                ("=" (rx (+ (or ">" "<" "|" "/" "~" ":" "!" "="))))
                                ;; ;; ;;;
                                (";" (rx (+ ";")))
                                ;; && &&&
                                ("&" (rx (+ "&")))
                                ;; !! !!! !. !: !!. != !== !~
                                ("!" (rx (+ (or "=" "!" "\." ":" "~"))))
                                ;; ?? ??? ?:  ?=  ?.
                                ("?" (rx (or ":" "=" "\." (+ "?"))))
                                ;; %% %%%
                                ("%" (rx (+ "%")))
                                ;; |> ||> |||> ||||> |] |} || ||| |-> ||-||
                                ;; |->>-||-<<-| |- |== ||=||
                                ;; |==>>==<<==<=>==//==/=!==:===>
                                ("|" (rx (+ (or ">" "<" "|" "/" ":" "!" "}" "\]"
                                                "-" "=" ))))
                                ;; \\ \\\ \/
                                ("\\" (rx (or "/" (+ "\\"))))
                                ;; ++ +++ ++++ +>
                                ("+" (rx (or ">" (+ "+"))))
                                ;; :: ::: :::: :> :< := :// ::=
                                (":" (rx (or ">" "<" "=" "//" ":=" (+ ":"))))
                                ;; // /// //// /\ /* /> /===:===!=//===>>==>==/
                                ("/" (rx (+ (or ">"  "<" "|" "/" "\\" "\*" ":" "!"
                                                "="))))
                                ;; .. ... .... .= .- .? ..= ..<
                                ("\." (rx (or "=" "-" "\?" "\.=" "\.<" (+ "\."))))
                                ;; -- --- ---- -~ -> ->> -| -|->-->>->--<<-|
                                ("-" (rx (+ (or ">" "<" "|" "~" "-"))))
                                ;; *> */ *)  ** *** ****
                                ("*" (rx (or ">" "/" ")" (+ "*"))))
                                ;; www wwww
                                ("w" (rx (+ "w")))
                                ;; <> <!-- <|> <: <~ <~> <~~ <+ <* <$ </  <+> <*>
                                ;; <$> </> <|  <||  <||| <|||| <- <-| <-<<-|-> <->>
                                ;; <<-> <= <=> <<==<<==>=|=>==/==//=!==:=>
                                ;; << <<< <<<<
                                ("<" (rx (+ (or "\+" "\*" "\$" "<" ">" ":" "~"  "!"
                                                "-"  "/" "|" "="))))
                                ;; >: >- >>- >--|-> >>-|-> >= >== >>== >=|=:=>>
                                ;; >> >>> >>>>
                                (">" (rx (+ (or ">" "<" "|" "/" ":" "=" "-"))))
                                ;; #: #= #! #( #? #[ #{ #_ #_( ## ### #####
                                ("#" (rx (or ":" "=" "!" "(" "\?" "\[" "{" "_(" "_"
                                             (+ "#"))))
                                ;; ~~ ~~~ ~=  ~-  ~@ ~> ~~>
                                ("~" (rx (or ">" "=" "-" "@" "~>" (+ "~"))))
                                ;; __ ___ ____ _|_ __|____|_
                                ("_" (rx (+ (or "_" "|"))))
                                ;; Fira code: 0xFF 0x12
                                ("0" (rx (and "x" (+ (in "A-F" "a-f" "0-9")))))
                                ;; Fira code:
                                "Fl"  "Tl"  "fi"  "fj"  "fl"  "ft"
                                ;; The few not covered by the regexps.
                                "{|"  "[|"  "]#"  "(*"  "}#"  "$>"  "^="))
      ;; Enables ligature checks globally in all buffers. You can also do it
      ;; per mode with `ligature-mode'.
      (global-ligature-mode))
    :hook
    (after-init . my/setup-ligatures))
#+end_src
**** [[https://git.sr.ht/~protesilaos/modus-themes][modus-themes]]
Accessible themes for GNU Emacs, conforming with the highest standard for colour contrast between background and foreground values (WCAG AAA)
https://protesilaos.com/emacs/modus-themes

#+begin_src emacs-lisp
  (use-package modus-themes
    :demand t
    :bind
    (:map my/toggle-map
          ("t" . modus-themes-toggle))
    :custom
    ;; Add all your customizations prior to loading the themes
    (modus-themes-italic-constructs t)
    (modus-themes-bold-constructs nil)

    :config
    ;; Load the theme of your choice.
    (load-theme 'modus-operandi :no-confirm))
#+end_src
**** [[https://github.com/rainstormstudio/nerd-icons.el.git][nerd-icons]]
A Library for Nerd Font icons. Required for modline icons.
#+begin_src emacs-lisp
  (use-package nerd-icons)
#+end_src

**** [[https://github.com/haji-ali/procress.git][procress]]
display LaTeX compilation information in the mode line
#+begin_src emacs-lisp
  (use-package procress
    :straight (:host github :repo "haji-ali/procress")
    :after doom-modeline
    :commands procress-auctex-mode
    :hook
    (LaTeX-mode . procress-auctex-mode)
    :config
    (procress-load-default-svg-images))
#+end_src

**** [[https://github.com/emacs-straight/spacious-padding.git][spacious-padding]]
Increase the padding/spacing of GNU Emacs frames and windows.
#+begin_src emacs-lisp
  (use-package spacious-padding
    :custom
    (spacious-padding-widths '(:internal-border-width 15 :right-divider-width 10 :scroll-bar-width 8))
    :hook
    (after-init . spacious-padding-mode))
#+end_src
**** [[https://codeberg.org/joostkremers/visual-fill-column.git][visual-fill-column]]
#+begin_src emacs-lisp
  (use-package visual-fill-column
    :bind (:map my/toggle-map ("w" . visual-fill-column-mode)))
#+end_src
*** UX
**** autorevert :build_in:
Revert buffers when the underlying file has changed
#+begin_src emacs-lisp
  (use-package autorevert
    :custom
    ;; Revert Dired and other buffers
    (global-auto-revert-non-file-buffers t)
    :hook
    (after-init . global-auto-revert-mode))
#+end_src

**** delsel :build_in:
Replace selected text when typing
#+begin_src emacs-lisp
  (use-package delsel
    :hook
    ((prog-mode conf-mode text-mode) . delete-selection-mode))
#+end_src

**** elec-pair :build_in:
Automatically add closing parentheses, quotes, etc.
#+begin_src emacs-lisp
  (use-package elec-pair
    :hook
    ((prog-mode conf-mode) . electric-pair-mode))
#+end_src

**** [[https://github.com/roman/golden-ratio.el.git][golden-ratio]]
When working with many windows at the same time, each window has a size that is not convenient for editing.
#+begin_src emacs-lisp
  (use-package golden-ratio
    :custom
    (golden-ratio-exclude-modes '(speedbar-mode vundo-mode minimap-sb-mode))
    (golden-ratio-exclude-buffer-regexp '(" ?\\*MINIMAP\\*"))
    ;; (golden-ratio-auto-scale t)
    :config
    (add-to-list 'golden-ratio-inhibit-functions
                 (lambda ()
                   (and which-key--buffer
                        (window-live-p (get-buffer-window which-key--buffer)))))
    :hook
    (after-init . golden-ratio-mode))
#+end_src
**** [[https://github.com/dengste/minimap.git][minimap]]
#+begin_src emacs-lisp
  (use-package minimap
    :custom
    (minimap-window-location 'right)
    (minimap-hide-fringes t)
    (minimap-width-fraction 0.05)
    :config
    (with-eval-after-load 'golden-ratio
      (add-to-list 'golden-ratio-inhibit-functions
                   (lambda ()
                     (and minimap-buffer-name
                          (window-live-p (get-buffer-window minimap-buffer-name)))))
      (add-to-list 'golden-ratio-exclude-buffer-names `(,minimap-buffer-name)))
    :bind
    (:map my/toggle-map
          ("m" . minimap-mode)))
#+end_src
**** paren :build_in:
Paren mode for highlighting matcing paranthesis

#+begin_src emacs-lisp
  (use-package paren
    :custom
    (show-paren-style 'parenthesis)
    (show-paren-when-point-in-periphery t)
    (show-paren-when-point-inside-paren nil)
    :hook
    (prog-mode . show-paren-mode))
#+end_src

**** recentf :build_in:

50 Recents files with some exclusion (regex patterns).

#+begin_src emacs-lisp
  (use-package recentf
    :custom
    (recentf-keep '(file-remote-p file-readable-p))
    (recentf-max-menu-items 10)
    (recentf-max-saved-items 100)
    :config
    (add-to-list 'recentf-exclude
                 (recentf-expand-file-name no-littering-var-directory))
    :bind
    (:map my/open-map
          ("r" . recentf-open))
    :hook
    (after-init . recentf-mode))
#+end_src
**** repeat :build_in:
Enable repeat maps
#+begin_src emacs-lisp
  (use-package repeat
    :hook
    (after-init . repeat-mode))
#+end_src

**** [[https://github.com/daichirata/emacs-rotate.git][rotate]]
#+begin_src emacs-lisp
  (use-package rotate
    :bind
    (:repeat-map my/window-map
                 ("R" . rotate-layout)
                 ("W" . rotate-window)))
#+end_src

**** savehist :build_in:
#+begin_src emacs-lisp
  (use-package savehist
    :custom
    (kill-ring-max 50)
    (history-length 50)
    (savehist-additional-variables
     '(kill-ring
       command-history
       set-variable-value-history
       custom-variable-history
       query-replace-history
       read-expression-history
       minibuffer-history
       read-char-history
       face-name-history
       bookmark-history
       file-name-history))
    ;; No duplicates in history
    (history-delete-duplicates t)
    :config
    (put 'minibuffer-history         'history-length 50)
    (put 'file-name-history          'history-length 50)
    (put 'set-variable-value-history 'history-length 25)
    (put 'custom-variable-history    'history-length 25)
    (put 'query-replace-history      'history-length 25)
    (put 'read-expression-history    'history-length 25)
    (put 'read-char-history          'history-length 25)
    (put 'face-name-history          'history-length 25)
    (put 'bookmark-history           'history-length 25)
    :hook
    ;;Start history mode.
    (after-init . savehist-mode))
#+end_src

**** saveplace :build_in:
Record cursor position from one session to the other
#+begin_src emacs-lisp
  (use-package saveplace
    :hook
    (after-init . save-place-mode))
#+end_src

**** time-stamp :build_in:
Automatically update file timestamps when file is saved
#+begin_src emacs-lisp
  (use-package time-stamp
    :custom
    (time-stamp-active t)
    (time-stamp-format "%04Y-%02m-%02d %02H:%02M:%02S (%U)")
    :hook
    (write-file . time-stamp))
#+end_src

**** windmove :build_in:
Navigate between windows with Shift-arrow
#+begin_src emacs-lisp :tangel no
  (use-package windmove
    :demand t
    :config
    (when (fboundp 'windmove-default-keybindings)
      (windmove-default-keybindings)))
#+end_src

**** winner :build_in:
Undo and redo changes to window configuration
#+begin_src emacs-lisp
  (use-package winner
    :hook
    (after-init . winner-mode))
#+end_src

**** [[https://github.com/joostkremers/writeroom-mode.git][writeroom-mode]]
#+begin_src emacs-lisp
  (use-package writeroom-mode
    :bind (:map my/toggle-map ("z" . writeroom-mode)))
#+end_src
*** Org
**** [[https://git.savannah.gnu.org/git/emacs/org-mode.git][org]]
Let's include a newer version of org-mode than the one that is built in. We're going
to manually remove the org directories from the load path, to ensure the version we
want is prioritized instead.

Agenda view and task management has been inspired by https://github.com/rougier/emacs-gtd

#+begin_src emacs-lisp
  (use-package org
    :custom
    (org-ellipsis " ▾")
    (org-src-fontify-natively t)
    (org-fontify-quote-and-verse-blocks t)
    (org-src-tab-acts-natively t)
    (org-edit-src-content-indentation 2)
    (org-hide-block-startup nil)
    (org-src-preserve-indentation nil)
    ;; Return or left-click with mouse follows link
    (org-return-follows-link t)
    (org-mouse-1-follows-link t)
    ;; Display links as the description provided
    (org-link-descriptive t)

    ;; Todo
    (org-todo-keywords
     '((sequence
        "PROJ(p)"  ; A project, which usually contains other tasks
        "TODO(t)"  ; A task that needs doing & is ready to do
        "NEXT(n)"  ; Next task in a project
        "STRT(s)"  ; A task that is in progress
        "WAIT(w)"  ; Something external is holding up this task
        "HOLD(h)"  ; This task is paused/on hold because of me
        "|"
        "DONE(d)"  ; Task successfully completed
        "KILL(k)") ; Task was cancelled, aborted or is no longer applicable
       (sequence
        "[ ](T)"   ; A task that needs doing
        "[-](S)"   ; Task is in progress
        "[?](W)"   ; Task is being held up or paused
        "|"
        "[X](D)"))) ; Task was completed
    (org-todo-keyword-faces
     '(("[-]"  . +org-todo-active)
       ("STRT" . +org-todo-active)
       ("[?]"  . +org-todo-onhold)
       ("WAIT" . +org-todo-onhold)
       ("HOLD" . +org-todo-onhold)
       ("PROJ" . +org-todo-project)))

    ;; Add timstamp to items when done
    (org-log-done 'time)

    ;; org capture
    (org-capture-templates
     `(("i" "Inbox" entry  (file "agenda/inbox.org")
        ,(concat "* TODO %?\n"
                 "/Entered on/ %U"))
       ("m" "Meeting" entry  (file+headline "agenda/agenda.org" "Future")
        ,(concat "* <%<%Y-%m-%d %a %H:00>> %? :meeting:\n"))
       ("n" "Note" entry  (file "agenda/notes.org")
        ,(concat "* Note (%a)\n"
                 "/Entered on/ %U\n" "\n" "%?"))))

    ;; org-agenda
    (org-agenda-files
     (mapcar 'file-truename
             (file-expand-wildcards (concat org-directory "agenda/*.org"))))
    ;; Refile and Archive
    (org-refile-use-outline-path 'file)
    (org-outline-path-complete-in-steps nil)
    (org-refile-targets `((,(expand-file-name  "agenda/agenda.org" org-directory) :maxlevel . 3)
                          (,(expand-file-name  "agenda/projects.org" org-directory) :regexp . "\\(?:\\(?:Note\\|Task\\)s\\)")
                          (,(expand-file-name  "agenda/literature.org" org-directory) :maxlevel . 2)
                          (,(expand-file-name  "agenda/scheduled.org" org-directory) :maxlevel . 2)))
    (org-agenda-custom-commands
     '(("g" "Get Things Done (GTD)"
        ((agenda ""
                 ((org-agenda-span 'day)
                  (org-agenda-start-day "today")
                  (org-agenda-skip-function
                   '(org-agenda-skip-entry-if 'deadline))
                  (org-deadline-warning-days 0)))
         (todo "PROJ"
               ((org-agenda-skip-function
                 '(org-agenda-skip-subtree-if 'nottodo '("NEXT" "STRT")))
                (org-agenda-overriding-header "Active Projects:")))
         (todo "STRT"
               ((org-agenda-skip-function
                 '(org-agenda-skip-entry-if 'deadline))
                (org-agenda-sorting-strategy '(priority-down category-keep effort-up))
                (org-agenda-prefix-format "  %i %-12:c [%e] ")
                (org-agenda-overriding-header "\nActive Tasks\n")
                ))  ; Exclude entries with LITERATURE category
         (todo "NEXT"
               ((org-agenda-skip-function
                 '(org-agenda-skip-entry-if 'deadline))
                (org-agenda-sorting-strategy '(priority-down category-keep effort-up))
                (org-agenda-prefix-format "  %i %-12:c [%e] ")
                (org-agenda-overriding-header "\nNext Tasks\n")))
         (agenda nil
                 ((org-agenda-entry-types '(:deadline))
                  (org-agenda-format-date "")
                  (org-deadline-warning-days 7)
                  (org-agenda-skip-function
                   '(org-agenda-skip-entry-if 'notregexp "\\* NEXT"))
                  (org-agenda-overriding-header "\nDeadlines")))
         (tags-todo "inbox"
                    ((org-agenda-prefix-format "  %?-12t% s")
                     (org-agenda-overriding-header "\nInbox\n")))
         (todo "HOLD|WAIT"
               ((org-agenda-skip-function
                 '(org-agenda-skip-entry-if 'deadline))
                (org-agenda-sorting-strategy '(priority-down category-keep effort-up))
                (org-agenda-prefix-format "  %i %-12:c [%e] ")
                (org-agenda-overriding-header "\nPaused Tasks\n")))
         (tags "CLOSED>=\"<today>\""
               ((org-agenda-overriding-header "\nCompleted today\n"))))
        ((org-agenda-category-filter-preset '("-LITERATURE"))))
       ("l" "Literature" tags-todo "literature"
        ((org-agenda-sorting-strategy '(priority-down category-keep effort-up))
         (org-agenda-prefix-format "  %i %-12:c [%e] ")))))

    :preface
    ;; https://github.com/rougier/emacs-gtd#activating-tasks
    (defun my/log-todo-next-creation-date (&rest ignore)
      "Log NEXT creation time in the property drawer under the key 'ACTIVATED'"
      (when (and (string= (org-get-todo-state) "NEXT")
                 (not (org-entry-get nil "ACTIVATED")))
        (org-entry-put nil "ACTIVATED" (format-time-string "[%Y-%m-%d]"))))
    ;; Save the corresponding buffers
    (defun my/gtd-save-org-buffers ()
      "Save `org-agenda-files' buffers without user confirmation.
              See also `org-save-all-org-buffers'"
      (interactive)
      (message "Saving org-agenda-files buffers...")
      (save-some-buffers t (lambda ()
                             (when (member (buffer-file-name) org-agenda-files)
                               t)))
      (message "Saving org-agenda-files buffers... done"))

    ;; archive all DONE tasks in subtree
    ;; https://stackoverflow.com/questions/6997387
    (defun org-archive-done-tasks ()
      (interactive)
      (org-map-entries
       (lambda ()
         (org-archive-subtree)
         (setq org-map-continue-from (org-element-property :begin (org-element-at-point))))
       "/DONE" 'tree))
    :hook
    (org-after-todo-state-change . my/log-todo-next-creation-date)
    :config
    (advice-add 'org-refile :after
                (lambda (&rest _)
                  (my/gtd-save-org-buffers)))
    :bind
    (:map my/leader-map
          ("c" . org-capture)
          :map my/open-map
          ("a" . org-agenda)))

  (use-package ox-latex
    :straight nil
    :after org
    :config
    ;; https://orgmode.org/manual/LaTeX-specific-export-settings.html
    (add-to-list 'org-latex-packages-alist
                 '("AUTO" "babel" t ("pdflatex")))
    (add-to-list 'org-latex-packages-alist
                 '("AUTO" "polyglossia" t ("xelatex" "lualatex")))
    (add-to-list 'org-latex-classes
                 '("koma-article"
                   "\\documentclass{scrartcl}"
                   ("\\section{%s}" . "\\section*{%s}")
                   ("\\subsection{%s}" . "\\subsection*{%s}")
                   ("\\subsubsection{%s}" . "\\subsubsection*{%s}")
                   ("\\paragraph{%s}" . "\\paragraph*{%s}")
                   ("\\subparagraph{%s}" . "\\subparagraph*{%s}")))
    (add-to-list 'org-latex-classes
                 '("koma-letter"
                   "\\documentclass{scrlttr2}"
                   ("\\section{%s}" . "\\section*{%s}")
                   ("\\subsection{%s}" . "\\subsection*{%s}")
                   ("\\subsubsection{%s}" . "\\subsubsection*{%s}")
                   ("\\paragraph{%s}" . "\\paragraph*{%s}")
                   ("\\subparagraph{%s}" . "\\subparagraph*{%s}"))))

  (use-package ox-beamer
    :straight nil
    :after org
    :config
    (add-to-list 'org-beamer-environments-extra
                 '("onlyenv" "O" "\\begin{onlyenv}%a" "\\end{onlyenv}")))

  (use-package ox-extra
    :straight nil
    :after org
    :config
    (ox-extras-activate '(ignore-headlines)))
#+end_src

**** [[https://github.com/awth13/org-appear.git][org-appear]]
*test* /aaa/ =babab=
#+begin_src emacs-lisp
  (use-package org-appear
    :after org
    :hook (org-mode . org-appear-mode))
#+end_src
**** [[https://github.com/yilkalargaw/org-auto-tangle.git][org-auto-tangle]]
#+begin_src emacs-lisp
  (use-package org-auto-tangle
    :after org
    :hook (org-mode . org-auto-tangle-mode))
#+end_src
**** [[https://github.com/Kungsgeten/org-brain.git][org-brain]]
#+begin_src emacs-lisp
  (use-package org-brain
    :after org org-noter
    :preface
    ;; from org brain README
    ;; Here’s a command which uses org-cliplink to add a link from the clipboard
    ;; as an org-brain resource.
    ;; It guesses the description from the URL title.
    ;; Here I’ve bound it to L in org-brain-visualize.
    (defun org-brain-cliplink-resource ()
      "Add a URL from the clipboard as an org-brain resource.
    Suggest the URL title as a description for resource."
      (interactive)
      (let ((url (org-cliplink-clipboard-content)))
        (org-brain-add-resource
         url
         (org-cliplink-retrieve-title-synchronously url)
         t)))

    (defun org-brain-open-org-noter (entry)
      "Open `org-noter' on the ENTRY.
    If run interactively, get ENTRY from context."
      (interactive (list (org-brain-entry-at-pt)))
      (org-with-point-at (org-brain-entry-marker entry)
        (org-noter)))

    (defun org-brain-insert-resource-icon (link)
      "Insert an icon, based on content of org-mode LINK."
      (insert (format "%s "
                      (cond ((string-prefix-p "brain:" link)
                             (nerd-icons-flicon "brain"))
                            ((string-prefix-p "info:" link)
                             (nerd-icons-octicon "info"))
                            ((string-prefix-p "help:" link)
                             (nerd-icons-material "help"))
                            ((string-prefix-p "http" link)
                             (nerd-icons-icon-for-url link))
                            (t
                             (nerd-icons-icon-for-file link))))))

    :config
    (add-hook 'org-brain-after-resource-button-functions #'org-brain-insert-resource-icon)
    :custom
    (org-id-track-globally t)
    (org-id-locations-file (expand-file-name "/org-id-locations" user-emacs-directory))
    (org-brain-visualize-default-choices 'all)
    (org-brain-title-max-length 24)
    (org-brain-include-file-entries t)
    (org-brain-file-entries-use-title t)
    :commands
    org-brain-visualize
    :hook
    (before-save . org-brain-ensure-ids-in-buffer))
#+end_src

**** [[https://github.com/rexim/org-cliplink.git][org-cliplink]]
A simple command that takes a URL from the clipboard and inserts an org-mode link with a title of a page found by the URL into the current buffer.

#+begin_src emacs-lisp
  (use-package org-cliplink
    :after org)
#+end_src

**** [[https://github.com/minad/org-modern.git][org-modern]]
This package implements a modern style for your Org buffers using font locking and text properties. The package styles headlines, keywords, tables and source blocks.

#+begin_src emacs-lisp
  (use-package org-modern
    :hook (org-mode . global-org-modern-mode)
    :after (:any org org-agenda)
    :custom
    (org-modern-star '("◉" "○" "◇"))
    (org-modern-label-border 0.3)

    ;; Edit settings
    (org-auto-align-tags t)
    (org-tags-column 0)
    (org-catch-invisible-edits 'show-and-error)
    (org-special-ctrl-a/e t)
    (org-insert-heading-respect-content t)

    ;; Org styling, hide markup etc.
    (org-hide-emphasis-markers t)
    (org-pretty-entities t)

    ;; Agenda styling
    (org-agenda-tags-column 0)
    (org-agenda-block-separator ?─)
    (org-agenda-time-grid
     '((daily today require-timed)
       (800 1000 1200 1400 1600 1800 2000)
       " ┄┄┄┄┄ " "┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄")
     org-agenda-current-time-string
     "⭠ now ─────────────────────────────────────────────────"))
#+end_src

**** [[https://github.com/org-noter/org-noter.git][org-noter]]

#+begin_src emacs-lisp
  (use-package org-noter
    :after org
    :custom
    ;; The WM can handle splits
    ;; org-noter-notes-window-location 'other-frame
    ;; Please stop opening frames
    (org-noter-always-create-frame nil)
    ;; I want to see the whole file
    (org-noter-hide-other nil)
    ;; Everything is relative to the main notes file
    ;; org-noter-notes-search-path (list bibtex-completion-notes-path)
    (org-noter-highlight-selected-text t)
    :hook
    ;; Org-noter’s purpose is to let you create notes that are kept in sync when
    ;; you scroll through the [PDF etc] document
    (org-noter-insert-heading . org-id-get-create))
#+end_src

**** [[https://github.com/marcinkoziej/org-pomodoro.git][org-pomodoro]]
#+begin_src emacs-lisp
  (use-package org-pomodoro
    :custom
    (org-pomodoro-audio-player (or (executable-find "paplay")
                                   org-pomodoro-audio-player))
    :config
    (use-package alert
      :config
      (alert-add-rule :category "org-pomodoro"
                      :style (cond (alert-growl-command
                                    'growl)
                                   (alert-notifier-command
                                    'notifier)
                                   (alert-libnotify-command
                                    'libnotify)
                                   (alert-default-style))))
    :bind
    (:map org-mode-map
          ("C-c p" . org-pomodoro)
          :map org-agenda-keymap
          ("p" . org-pomodoro)))
#+end_src

**** [[https://github.com/snosov1/toc-org.git][toc-org]]
Let's install and load the =toc-org= package after org mode is loaded. This is the
package that automatically generates an up to date table of contents for us.

#+begin_src emacs-lisp
  (use-package toc-org
    :after org
    :hook
    (org-mode . toc-org-enable))
#+end_src

*** Tools
**** [[https://github.com/radian-software/ctrlf.git][ctrlf]]
#+begin_src emacs-lisp
  (use-package ctrlf
    :hook
    ((after-init . ctrlf-mode)
     (pdf-isearch-minor-mode . (lambda () (ctrlf-local-mode -1)))))
#+end_src

**** ediff :build_in:
The ediff package is utilized to handle file differences in emacs.
We will tweak the Emacs built-in ediff configuration a bit.
[[https://panadestein.github.io/emacsd/#org5917c00][Emacs literate configuration]]

#+begin_src emacs-lisp
  (use-package ediff
    :preface
    (defvar my-ediff-original-windows nil)
    (defun my/store-pre-ediff-winconfig ()
      "This function stores the current window configuration before opening ediff."
      (setq my/ediff-original-windows (current-window-configuration)))
    (defun my/restore-pre-ediff-winconfig ()
      "This function resets the original window arrangement."
      (set-window-configuration my/ediff-original-windows))
    :custom
    (ediff-window-setup-function 'ediff-setup-windows-plain)
    (ediff-split-window-function 'split-window-horizontally)
    :hook
    ((ediff-before-setup . my/store-pre-ediff-winconfig)
     (ediff-quit . my/restore-pre-ediff-winconfig)))
#+end_src

**** [[https://github.com/skeeto/elfeed.git][elfeed]]
An Emacs web feeds client
#+begin_src emacs-lisp
  (use-package elfeed
    :bind
    (:map my/open-map
          ("f" . elfeed))
    :config
    (setq elfeed-feeds
          '("https://github.com/emacs-straight/ascii-art-to-unicode/releases.atom"
            "https://github.com/emacs-straight/auctex/releases.atom"
            "https://github.com/dholm/benchmark-init-el/releases.atom"
            "https://github.com/elken/cape-yasnippet/releases.atom"
            "https://github.com/minad/cape/releases.atom"
            "https://github.com/emacs-citar/citar/releases.atom"
            "https://github.com/andras-simonyi/citeproc-el/releases.atom"
            "https://github.com/emacs-straight/compat/releases.atom"
            "https://github.com/necaris/conda.el/releases.atom"
            "https://github.com/minad/consult/releases.atom"
            "https://codeberg.org/akib/emacs-corfu-terminal/releases.atom"
            "https://github.com/emacs-straight/corfu/releases.atom"
            "https://github.com/magnars/dash.el/releases.atom"
            "https://github.com/seagle0128/doom-modeline/releases.atom"
            "https://github.com/emacs-straight/eglot/releases.atom"
            "https://github.com/dimitri/el-get/releases.atom"
            "https://github.com/emacs-straight/eldoc/releases.atom"
            "https://github.com/Wilfred/elisp-refs/releases.atom"
            "https://github.com/emacs-tree-sitter/elisp-tree-sitter/releases.atom"
            "https://github.com/jwiegley/emacs-async/releases.atom"
            "https://github.com/emacs-dashboard/emacs-dashboard/releases.atom"
            "https://github.com/lassik/emacs-format-all-the-code/releases.atom"
            "https://github.com/lassik/emacs-language-id/releases.atom"
            "https://github.com/justbur/emacs-which-key/releases.atom"
            "https://github.com/emacs-straight/emacsmirror-mirror/releases.atom"
            "https://github.com/oantolin/embark/releases.atom"
            "https://github.com/cask/epl/releases.atom"
            "https://github.com/Somelauw/evil-org-mode/releases.atom"
            "https://github.com/emacs-evil/evil/releases.atom"
            "https://github.com/emacs-straight/external-completion/releases.atom"
            "https://github.com/rejeep/f.el/releases.atom"
            "https://github.com/flycheck/flycheck/releases.atom"
            "https://github.com/emacs-straight/flymake/releases.atom"
            "https://github.com/d12frosted/flyspell-correct/releases.atom"
            "https://github.com/nschum/fringe-helper.el/releases.atom"
            "https://github.com/nonsequitur/git-gutter-fringe-plus/releases.atom"
            "https://github.com/emacsorphanage/git-gutter-fringe/releases.atom"
            "https://github.com/nonsequitur/git-gutter-plus/releases.atom"
            "https://github.com/emacsorphanage/git-gutter/releases.atom"
            "https://codeberg.org/pidu/git-timemachine/releases.atom"
            "https://github.com/emacs-straight/gnu-elpa-mirror/releases.atom"
            "https://github.com/roman/golden-ratio.el/releases.atom"
            "https://github.com/emacs-evil/goto-chg/releases.atom"
            "https://github.com/karthink/gptel/releases.atom"
            "https://github.com/Wilfred/helpful/releases.atom"
            "https://github.com/purcell/inheritenv/releases.atom"
            "https://github.com/emacs-straight/jsonrpc/releases.atom"
            "https://github.com/emacs-straight/let-alist/releases.atom"
            "https://github.com/mickeynp/ligature.el/releases.atom"
            "https://github.com/immerrr/lua-mode/releases.atom"
            "https://github.com/magit/magit/releases.atom"
            "https://github.com/minad/marginalia/releases.atom"
            "https://github.com/jrblevin/markdown-mode/releases.atom"
            "https://github.com/melpa/melpa/releases.atom"
            "https://github.com/meow-edit/meow/releases.atom"
            "https://github.com/protesilaos/modus-themes/releases.atom"
            "https://github.com/rainstormstudio/nerd-icons.el/releases.atom"
            "https://github.com/emacscollective/no-littering/releases.atom"
            "https://github.com/douglasdavis/numpydoc.el/releases.atom"
            "https://github.com/oantolin/orderless/releases.atom"
            "https://github.com/awth13/org-appear/releases.atom"
            "https://github.com/yilkalargaw/org-auto-tangle/releases.atom"
            "https://github.com/Kungsgeten/org-brain/releases.atom"
            "https://github.com/rexim/org-cliplink/releases.atom"
            "https://github.com/minad/org-modern/releases.atom"
            "https://github.com/org-noter/org-noter/releases.atom"
            "https://github.com/emacs-straight/org-mode/releases.atom"
            "https://github.com/joostkremers/parsebib/releases.atom"
            "https://github.com/vedang/pdf-tools/releases.atom"
            "https://github.com/emacsorphanage/pkg-info/releases.atom"
            "https://codeberg.org/akib/emacs-popon/releases.atom"
            "https://github.com/kcyarn/pretty-speedbar/releases.atom"
            "https://github.com/fritzgrabo/project-tab-groups/releases.atom"
            "https://github.com/emacs-straight/project/releases.atom"
            "https://github.com/paetzke/py-isort.el/releases.atom"
            "https://github.com/Wilfred/pyimport/releases.atom"
            "https://github.com/pythonic-emacs/pythonic/releases.atom"
            "https://github.com/emacs-straight/queue/releases.atom"
            "https://github.com/magnars/s.el/releases.atom"
            "https://github.com/cask/shut-up/releases.atom"
            "https://github.com/emacsorphanage/sr-speedbar/releases.atom"
            "https://github.com/radian-software/straight.el/releases.atom"
            "https://github.com/akicho8/string-inflection/releases.atom"
            "https://github.com/fritzgrabo/tab-bar-echo-area/releases.atom"
            "https://github.com/emacsorphanage/tablist/releases.atom"
            "https://github.com/Crandel/tempel-collection/releases.atom"
            "https://github.com/minad/tempel/releases.atom"
            "https://github.com/snosov1/toc-org/releases.atom"
            "https://github.com/emacs-straight/tramp/releases.atom"
            "https://github.com/magit/transient/releases.atom"
            "https://github.com/emacs-tree-sitter/tree-sitter-langs/releases.atom"
            "https://github.com/emacs-straight/undo-tree/releases.atom"
            "https://github.com/jwiegley/use-package/releases.atom"
            "https://github.com/emacs-straight/vertico/releases.atom"
            "https://codeberg.org/joostkremers/visual-fill-column/releases.atom"
            "https://github.com/emacs-straight/vundo/releases.atom"
            "https://github.com/magit/with-editor/releases.atom"
            "https://github.com/joostkremers/writeroom-mode/releases.atom"
            "https://github.com/emacs-straight/xref/releases.atom"
            "https://github.com/yoshiki/yaml-mode/releases.atom"
            "https://github.com/AndreaCrotti/yasnippet-snippets/releases.atom"
            "https://github.com/joaotavora/yasnippet/releases.atom"
            "https://github.com/zenlang/zen-mode/releases.atom")))
#+end_src
**** [[https://github.com/purcell/exec-path-from-shell.git][exec-path-from-shell]]
#+begin_src emacs-lisp
  (use-package exec-path-from-shell
    :config
    (defun my/copy-ssh-env ()
      (exec-path-from-shell-copy-env "SSH_AGENT_PID")
      (exec-path-from-shell-copy-env "SSH_AUTH_SOCK")
      (exec-path-from-shell-initialize))
    :hook
    (magit-credential . my/copy-ssh-env))
#+end_src

**** flyspell :build_in:
#+begin_src emacs-lisp
  (use-package flyspell
    :preface
    (defun my/restart-flyspell-mode ()
      (when flyspell-mode
        (flyspell-mode-off)
        (flyspell-mode-on)
        (flyspell-buffer)))
    :config
    (use-package ispell
      :custom
      (ispell-program-name "hunspell")
      (ispell-dictionary "en_US,de_DE")
      :config
      (ispell-set-spellchecker-params)
      (ispell-hunspell-add-multi-dic "en_US,de_DE"))
    (use-package flyspell-correct
      :bind (:map flyspell-mode-map ("C-;" . flyspell-correct-wrapper)
                  :map flyspell-mouse-map ("RET" . flyspell-correct-at-point)
                  ([mouse-1] . flyspell-correct-at-point)))
    :hook
    (((text-mode conf-mode org-mode) . flyspell-mode)
     (prog-mode . flyspell-prog-mode)
     (ispell-change-dictionary . restart-flyspell-mode)))
#+end_src

**** [[https://github.com/karthink/gptel.git][gptel]]
#+begin_src emacs-lisp
  (use-package gptel
    :custom
    (gptel-default-mode 'org-mode)
    :bind
    (:map my/open-map
          ("g". gptel))
    :commands (gptel gptel-send))
#+end_src

**** [[https://github.com/Wilfred/helpful.git][helpful]]
[[https://github.com/Wilfred/helpful][Helpful]] is an alternative to the built-in Emacs help that provides much more contextual information.
It is a bit slow to load so we do need load it explicitely.

#+begin_src emacs-lisp
  (use-package helpful
    :bind
    (([remap describe-function] . helpful-function)
     ([remap describe-symbol] . helpful-symbol)
     ([remap describe-variable] . helpful-variable)
     ([remap describe-command] . helpful-command)
     ([remap describe-key] . helpful-key)
     ("C-h K" . describe-keymap)
     :map helpful-mode-map
     ([remap revert-buffer] . helpful-update)))
#+end_src
**** [[https://github.com/vedang/pdf-tools.git][pdf-tools]]

#+begin_src emacs-lisp
  (use-package pdf-tools
    :magic ("%PDF" . pdf-view-mode)
    :config
    (pdf-tools-install :no-query)
    :custom
    (pdf-view-use-scaling t)
    (pdf-view-use-imagemagick nil))
#+end_src

**** re-builder :build_in:
Change re-builder syntax
#+begin_src emacs-lisp
  ;; https://www.masteringemacs.org/article/re-builder-interactive-regexp-builder
  (use-package re-builder
    :commands re-builder
    :custom
    (reb-re-syntax 'string))
#+end_src

**** server :build_in:

Server start.

#+begin_src emacs-lisp :tangle no
  (use-package server
    :config
    (unless (server-running-p)
      (server-start)))
#+end_src
**** term :build_in:
Major mode for interacting with a terminal
#+begin_src emacs-lisp
  (use-package term
    :commands term
    :unless (not (file-exists-p "/bin/zsh")) ; we only use it if shell exists
    :custom
    (shell-file-name "/bin/zsh")
    (explicit-shell-file-name "/bin/zsh"))
#+end_src

**** tramp :build_in:
remote file editing through ssh/scp.
#+begin_src emacs-lisp
  (use-package tramp
    :straight nil
    :custom
    (tramp-default-method "ssh")
    (tramp-encoding-shell "/usr/bin/zsh")
    (remote-file-name-inhibit-cache nil)
    (vc-ignore-dir-regexp
     (format "%s\\|%s"
             vc-ignore-dir-regexp
             tramp-file-name-regexp))
    :config
    (add-to-list 'tramp-connection-properties
                 (list (regexp-quote "/sshx:user@host:")
                       "remote-shell" "/bin/bash")))
#+end_src
**** [[https://github.com/emacs-straight/vundo.git][vundo]]
#+begin_src emacs-lisp
  (use-package vundo
    :bind
    (:map my/open-map
          ("u". vundo))
    :config
    (when (display-graphic-p)
      (setq vundo-glyph-alist vundo-unicode-symbols)))
#+end_src
*** Completion
**** [[https://github.com/minad/cape.git][cape]]
Cape provides Completion At Point Extensions which can be used in combination with Corfu, Company or the default completion UI. The completion backends used by completion-at-point are so called completion-at-point-functions (Capfs).
#+begin_src emacs-lisp
  (use-package cape
    ;; Bind dedicated completion commands
    ;; Alternative prefix keys: C-c p, M-p, M-+, ...
    :bind (:map my/completion-map
                ("p" . completion-at-point) ;; capf
                ("t" . complete-tag)        ;; etags
                ("d" . cape-dabbrev)        ;; or dabbrev-completion
                ("h" . cape-history)
                ("f" . cape-file)
                ("k" . cape-keyword)
                ("s" . cape-symbol)
                ("a" . cape-abbrev)
                ("l" . cape-line)
                ("w" . cape-dict)
                ("\\" . cape-tex)
                ("_" . cape-tex)
                ("^" . cape-tex)
                ("&" . cape-sgml)
                ("r" . cape-rfc1345))
    :init
    ;; Add `completion-at-point-functions', used by `completion-at-point'.
    ;; NOTE: The order matters!
    (add-to-list 'completion-at-point-functions #'cape-dabbrev)
    (add-to-list 'completion-at-point-functions #'cape-file)
    (add-to-list 'completion-at-point-functions #'cape-elisp-block)
    ;;(add-to-list 'completion-at-point-functions #'cape-history)
    (add-to-list 'completion-at-point-functions #'cape-keyword)
    (add-to-list 'completion-at-point-functions #'cape-tex)
    ;;(add-to-list 'completion-at-point-functions #'cape-sgml)
    ;;(add-to-list 'completion-at-point-functions #'cape-rfc1345)
    ;;(add-to-list 'completion-at-point-functions #'cape-abbrev)
    ;;(add-to-list 'completion-at-point-functions #'cape-dict)
    ;;(add-to-list 'completion-at-point-functions #'cape-symbol)

    ;; The advices are only needed on Emacs 28 and older.
    (when (< emacs-major-version 29)
      ;; Silence the pcomplete capf, no errors or messages!
      (advice-add 'pcomplete-completions-at-point :around #'cape-wrap-silent)

      ;; Ensure that pcomplete does not write to the buffer
      ;; and behaves as a pure `completion-at-point-function'.
      (advice-add 'pcomplete-completions-at-point :around #'cape-wrap-purify)))
#+end_src

**** [[https://github.com/emacs-citar/citar.git][citar]]
Citar provides a highly-configurable completing-read front-end to browse and act on BibTeX, BibLaTeX, and CSL JSON bibliographic data, and LaTeX, markdown, and org-cite editing support.
#+begin_src emacs-lisp
  (use-package citar
    :after nerd-icons org
    :custom
    (org-cite-insert-processor 'citar)
    (org-cite-follow-processor 'citar)
    (org-cite-activate-processor 'citar)
    (citar-bibliography org-cite-global-bibliography)
    (citar-at-point-function 'embark-act)
    (citar-notes-paths (list (concat org-directory "brain/bib_notes/")))
    (citar-templates `((main . "${author editor:30}     ${date year issued:4}     ${title:48}")
                       (suffix . "          ${=key= id:15}    ${=type=:12}    ${tags keywords:*}")
                       (preview . "${author editor} (${year issued date}) ${title}, ${journal journaltitle publisher container-title collection-title}.\n")
                       (note . ,(concat "#+TITLE: ${title}\n"
                                        "#+AUTHOR: ${author editor}\n"
                                        "#+DATE: ${date}\n"
                                        "#+SOURCE: ${doi url}\n"
                                        "#+CUSTOM_ID: ${=key= id}\n"
                                        "#+cite_export: biblatex ieee\n"
                                        (concat "#+bibliography: " (car citar-bibliography) "\n\n")
                                        "* Notes :ignore:\n"
                                        ":PROPERTIES:\n"
                                        ":NOTER_DOCUMENT: ${file} \n"
                                        ":END:\n\n"
                                        "* Summary :childless:showchildren:export:\n"
                                        "This is a summary of [citet:@${=key=}].\n"
                                        "** Bibliography :ignore:\n"
                                        ))))
    (citar-symbol-separator "  ")
    :config
    (defvar citar-indicator-files-icons
      (citar-indicator-create
       :symbol (nerd-icons-faicon
                "nf-fa-file_o"
                :face 'nerd-icons-green
                :v-adjust -0.1)
       :function #'citar-has-files
       :padding "  " ; need this because the default padding is too low for these icons
       :tag "has:files"))
    (defvar citar-indicator-links-icons
      (citar-indicator-create
       :symbol (nerd-icons-octicon
                "nf-oct-link"
                :face 'nerd-icons-orange
                :v-adjust 0.01)
       :function #'citar-has-links
       :padding "  "
       :tag "has:links"))
    (defvar citar-indicator-notes-icons
      (citar-indicator-create
       :symbol (nerd-icons-mdicon
                "nf-md-pencil"
                :face 'nerd-icons-blue
                :v-adjust 0.01)
       :function #'citar-has-notes
       :padding "  "
       :tag "has:notes"))
    (defvar citar-indicator-cited-icons
      (citar-indicator-create
       :symbol (nerd-icons-faicon
                "nf-fa-circle_o"
                :face 'nerd-icons-green)
       :function #'citar-is-cited
       :padding "  "
       :tag "is:cited"))
    (setq citar-indicators
          (list citar-indicator-files-icons
                citar-indicator-links-icons
                citar-indicator-notes-icons
                citar-indicator-cited-icons))
    ;; optional: org-cite-insert is also bound to C-c C-x C-@
    ;;:bind
    ;;(:map org-mode-map :package org ("C-c b" . #'org-cite-insert))
    (use-package citar-embark
      :config
      (citar-embark-mode))
    :hook
    ((LaTeX-mode . citar-capf-setup)
     (org-mode . citar-capf-setup)))
#+end_src

**** [[https://github.com/minad/consult.git][consult]]
additional featureful completion commands
#+begin_src emacs-lisp
  ;; Example configuration for Consult
  (use-package consult
    ;; Replace bindings. Lazily loaded due by `use-package'.
    :bind (([remap Info-search] . consult-info)
           ([remap recentf-open] . consult-recent-file)
           ([remap bookmark-jump]                 . consult-bookmark)
           ([remap goto-line]                     . consult-goto-line)
           ([remap imenu]                         . consult-imenu)
           ([remap locate]                        . consult-locate)
           ([remap load-theme]                    . consult-theme)
           ([remap man]                           . consult-man)
           ([remap recentf-open-files]            . consult-recent-file)
           ([remap switch-to-buffer]              . consult-buffer)
           ([remap switch-to-buffer-other-window] . consult-buffer-other-window)
           ([remap switch-to-buffer-other-frame]  . consult-buffer-other-frame)
           ([remap yank-pop]                      . consult-yank-pop)
           ("M-y" . consult-yank-pop)                ;; orig. yank-pop
           :map my/buffer-map
           ("b" . consult-buffer)                ;; orig. switch-to-buffer
           ("w" . consult-buffer-other-window) ;; orig. switch-to-buffer-other-window
           ("f" . consult-buffer-other-frame)  ;; orig. switch-to-buffer-other-frame
           :map project-prefix-map
           ("b" . consult-project-buffer)      ;; orig. project-switch-to-buffer
           :map goto-map
           ;; M-g bindings in `goto-map'
           ("e" . consult-compile-error)
           ("f" . consult-flymake)               ;; Alternative: consult-flycheck
           ("g" . consult-goto-line)             ;; orig. goto-line
           ("o" . consult-outline)               ;; Alternative: consult-org-heading
           ("m" . consult-mark)
           ("k" . consult-global-mark)
           ("i" . consult-imenu)
           ("I" . consult-imenu-multi)
           :map search-map
           ("d" . consult-find)
           ("D" . consult-locate)
           ("g" . consult-grep)
           ("G" . consult-git-grep)
           ("r" . consult-ripgrep)
           ("l" . consult-line)
           ("L" . consult-line-multi)
           ("k" . consult-keep-lines)
           ("u" . consult-focus-lines)
           ;; Isearch integration
           ("e" . consult-isearch-history)
           :map isearch-mode-map
           ("M-e" . consult-isearch-history)         ;; orig. isearch-edit-string
           ("M-s e" . consult-isearch-history)       ;; orig. isearch-edit-string
           ("M-s l" . consult-line)                  ;; needed by consult-line to detect isearch
           ("M-s L" . consult-line-multi)            ;; needed by consult-line to detect isearch
           ;; Minibuffer history
           :map minibuffer-local-map
           ("M-s" . consult-history)                 ;; orig. next-matching-history-element
           ("M-r" . consult-history))                ;; orig. previous-matching-history-element

    :custom
    ;; Optionally configure the register formatting. This improves the register
    ;; preview for `consult-register', `consult-register-load',
    ;; `consult-register-store' and the Emacs built-ins.
    (register-preview-delay 0.5)
    (register-preview-function #'consult-register-format)

    ;; Use Consult to select xref locations with preview
    (xref-show-xrefs-function #'consult-xref)
    (xref-show-definitions-function #'consult-xref)

    ;; Optionally configure the narrowing key.
    ;; Both < and C-+ work reasonably well.
    (consult-narrow-key "<") ;; "C-+"

    :config
    ;; Optionally tweak the register preview window.
    ;; This adds thin lines, sorting and hides the mode line of the window.
    (advice-add #'register-preview :override #'consult-register-window)

    ;; Optionally configure preview. The default value
    ;; is 'any, such that any key triggers the preview.
    ;; (setq consult-preview-key 'any)
    ;; (setq consult-preview-key "M-.")
    ;; (setq consult-preview-key '("S-<down>" "S-<up>"))
    ;; For some commands and buffer sources it is useful to configure the
    ;; :preview-key on a per-command basis using the `consult-customize' macro.
    (consult-customize
     consult-theme :preview-key '(:debounce 0.2 any)
     consult-ripgrep consult-git-grep consult-grep
     consult-bookmark consult-recent-file consult-xref
     consult--source-bookmark consult--source-file-register
     consult--source-recent-file consult--source-project-recent-file
     ;; :preview-key "M-."
     :preview-key '(:debounce 0.4 any))

    ;; Configure a different project root function.
    (with-eval-after-load 'projectile
      (autoload 'projectile-project-root "projectile")
      (setq consult-project-function (lambda (_) (projectile-project-root)))))
#+end_src
**** [[https://github.com/emacs-straight/corfu.git][corfu]]
Corfu is the minimalistic in-buffer completion counterpart of the Vertico minibuffer UI.
#+begin_src emacs-lisp
  (use-package corfu
    :custom
    ;; TAB cycle if there are only few candidates
    (completion-cycle-threshold 3)

    ;; Emacs 28: Hide commands in M-x which do not apply to the current mode.
    ;; Corfu commands are hidden, since they are not supposed to be used via M-x.
    (read-extended-command-predicate
     #'command-completion-default-include-p)

    ;; Enable indentation+completion using the TAB key.
    ;; `completion-at-point' is often bound to M-TAB.
    (tab-always-indent 'complete)

    ;; Additional Customisations
    (corfu-cycle t)                 ;; Enable cycling for `corfu-next/previous'
    (corfu-auto t)                  ;; Enable auto completion
    (corfu-auto-prefix 1)           ;; Complete with less prefix keys)
    (corfu-auto-delay 0.0)          ;; No delay for completion
    (corfu-echo-documentation 0.25) ;; Echo docs for current completion option
    (corfu-separator ?\s)           ;; Orderless field separator
    (corfu-quit-at-boundary nil)    ;; Never quit at completion boundary
    (corfu-quit-no-match t)         ;; Never quit, even if there is no match
    (corfu-preview-current t)       ;; Disable current candidate preview
    ;; (corfu-preselect 'prompt)      ;; Preselect the prompt
    (corfu-on-exact-match nil)      ;; Configure handling of exact matches
    ;; (corfu-scroll-margin 5)        ;; Use scroll margin

    :preface
    ;; fix uneeded duble return in eshell
    (defun corfu-send-shell (&rest _)
      "Send completion candidate when inside comint/eshell."
      (cond
       ((and (derived-mode-p 'eshell-mode) (fboundp 'eshell-send-input))
        (eshell-send-input))
       ((and (derived-mode-p 'comint-mode)  (fboundp 'comint-send-input))
        (comint-send-input))))

    ;; Completing in the minibuffer
    (defun corfu-enable-always-in-minibuffer ()
      "Enable Corfu in the minibuffer if Vertico/Mct are not active."
      (unless (or (bound-and-true-p mct--active)
                  (bound-and-true-p vertico--input)
                  (eq (current-local-map) read-passwd-map))
        ;; (setq-local corfu-auto nil) ;; Enable/disable auto completion
        (setq-local corfu-echo-delay nil ;; Disable automatic echo and popup
                    corfu-popupinfo-delay nil)
        (corfu-mode 1)))

    :config
    (when (fboundp 'straight-use-package)
      (add-to-list 'load-path
                   (expand-file-name "straight/build/corfu/extensions"
                                     straight-base-dir)))
    (require 'corfu-popupinfo)
    (eldoc-add-command #'corfu-insert)

    ;; Completing in the Eshell or Shell
    (advice-add #'corfu-insert :after #'corfu-send-shell)

    :hook
    ;; Recommended: Enable Corfu globally.
    ;; This is recommended since Dabbrev can be used globally (M-/).
    ;; See also `corfu-exclude-modes'.
    ((after-init . global-corfu-mode)
     (after-init . corfu-popupinfo-mode)
     ;; disable auto completion for eshell, such that the completion behavior is similar to widely used shells like Bash, Zsh or Fish.
     (eshell-mode-hook . (lambda ()
                           (setq-local corfu-auto nil)
                           (corfu-mode)))
     ;; Enable minibuffer completion
     (minibuffer-setup . corfu-enable-always-in-minibuffer)))

  (use-package corfu-terminal
    :if (display-graphic-p)
    :after corfu
    :hook
    (after-init . corfu-terminal-mode))
#+end_src

**** [[https://github.com/oantolin/embark.git][embark]]
Embark makes it easy to choose a command to run based on what is near point, both during a minibuffer completion session (in a way familiar to Helm or Counsel users) and in normal buffers.
#+begin_src emacs-lisp
  (use-package embark
    :after which-key
    :bind
    (("C-." . embark-act)         ;; pick some comfortable binding
     ;; ("C-:" . embark-dwim)        ;; good alternative: M-.
     ("C-h B" . embark-bindings)) ;; alternative for `describe-bindings'

    :custom
    ;; Optionally replace the key help with a completing-read interface
    (prefix-help-command #'embark-prefix-help-command)

    :preface
    ;; The built-in embark-verbose-indicator displays actions in a buffer along with their keybindings and the first line of their docstrings.
    ;; Users desiring a more compact display can use which-key instead with the following configuration:
    ;; ref.: https://github.com/oantolin/embark/wiki/Additional-Configuration#use-which-key-like-a-key-menu-prompt
    (defun embark-which-key-indicator ()
      "An embark indicator that displays keymaps using which-key.
    The which-key help message will show the type and value of the
    current target followed by an ellipsis if there are further
    targets."
      (lambda (&optional keymap targets prefix)
        (if (null keymap)
            (which-key--hide-popup-ignore-command)
          (which-key--show-keymap
           (if (eq (plist-get (car targets) :type) 'embark-become)
               "Become"
             (format "Act on %s '%s'%s"
                     (plist-get (car targets) :type)
                     (embark--truncate-target (plist-get (car targets) :target))
                     (if (cdr targets) "…" "")))
           (if prefix
               (pcase (lookup-key keymap prefix 'accept-default)
                 ((and (pred keymapp) km) km)
                 (_ (key-binding prefix 'accept-default)))
             keymap)
           nil nil t (lambda (binding)
                       (not (string-suffix-p "-argument" (cdr binding))))))))

    (defun embark-hide-which-key-indicator (fn &rest args)
      "Hide the which-key indicator immediately when using
  the completing-read prompter."
      (which-key--hide-popup-ignore-command)
      (let ((embark-indicators
             (remq #'embark-which-key-indicator embark-indicators)))
        (apply fn args)))

    :config
    ;; Show the Embark target at point via Eldoc.  You may adjust the Eldoc
    ;; strategy, if you want to see the documentation from multiple providers.
    (add-hook 'eldoc-documentation-functions #'embark-eldoc-first-target)
    ;; (setq eldoc-documentation-strategy #'eldoc-documentation-compose-eagerly)

    ;; Hide the mode line of the Embark live/completions buffers
    (add-to-list 'display-buffer-alist
                 '("\\`\\*Embark Collect \\(Live\\|Completions\\)\\*"
                   nil
                   (window-parameters (mode-line-format . none))))

    (setq embark-indicators
          '(embark-which-key-indicator
            embark-highlight-indicator
            embark-isearch-highlight-indicator))


    (advice-add #'embark-completing-read-prompter
                :around #'embark-hide-which-key-indicator))

  ;; Consult users will also want the embark-consult package.
  (use-package embark-consult
    :hook
    (embark-collect-mode . consult-preview-at-point-mode))
#+end_src

**** [[https://github.com/minad/marginalia.git][marginalia]]
#+begin_src emacs-lisp
  (use-package marginalia
    :after vertico
    :custom
    (marginalia-annotators '(marginalia-annotators-heavy marginalia-annotators-light nil))
    :hook
    (vertico-mode . marginalia-mode))
#+end_src

**** [[https://github.com/oantolin/orderless.git][orderless]]
Emacs completion style that matches multiple regexps in any order
#+begin_src emacs-lisp
  (use-package orderless
    :after vertico
    :preface
    ;; In combination with Orderless or other non-prefix completion styles like substring or flex,
    ;; host names and user names are not made available for completion after entering /ssh:.
    (defun basic-remote-try-completion (string table pred point)
      (and (vertico--remote-p string)
           (completion-basic-try-completion string table pred point)))
    (defun basic-remote-all-completions (string table pred point)
      (and (vertico--remote-p string)
           (completion-basic-all-completions string table pred point)))

    :config
    (add-to-list
     'completion-styles-alist
     '(basic-remote basic-remote-try-completion basic-remote-all-completions nil))

    :custom
    (completion-styles '(orderless basic))
    (completion-category-defaults nil)
    (completion-category-overrides '((file (styles basic-remote partial-completion)))))
#+end_src
**** [[https://github.com/minad/tempel.git][tempel]]
Tempel is a tiny template package for Emacs, which uses the syntax of the Emacs Tempo library. Tempo is an ancient temple of the church of Emacs. It is 27 years old, but still in good shape since it successfully resisted change over the decades. However it may look a bit dusty here and there. Therefore we present Tempel, a new implementation of Tempo with inline expansion and integration with recent Emacs facilities. Tempel takes advantage of the standard completion-at-point-functions mechanism which is used by Emacs for in-buffer completion.

#+begin_src emacs-lisp
  ;; Configure Tempel
  (use-package tempel
    ;; Require trigger prefix before template name when completing.
    :custom
    (tempel-trigger-prefix ">")
    (tempel-path my/templates-path)

    :bind (("M-+" . tempel-complete) ;; Alternative tempel-expand
           ("M-*" . tempel-insert))

    :preface
    ;; Setup completion at point
    (defun my/tempel-setup-capf ()
      ;; Add the Tempel Capf to `completion-at-point-functions'.
      ;; `tempel-expand' only triggers on exact matches. Alternatively use
      ;; `tempel-complete' if you want to see all matches, but then you
      ;; should also configure `tempel-trigger-prefix', such that Tempel
      ;; does not trigger too often when you don't expect it. NOTE: We add
      ;; `tempel-expand' *before* the main programming mode Capf, such
      ;; that it will be tried first.
      (setq-local completion-at-point-functions
                  (cons #'tempel-complete
                        completion-at-point-functions)))

    :hook
    ((conf-mode . my/tempel-setup-capf)
     (prog-mode . my/tempel-setup-capf)
     (text-mode . my/tempel-setup-capf))
    ;; Optionally make the Tempel templates available to Abbrev,
    ;; either locally or globally. `expand-abbrev' is bound to C-x '.
    ;; (add-hook 'prog-mode-hook #'tempel-abbrev-mode)
    ;; (global-tempel-abbrev-mode)
    )

  ;; Optional: Add tempel-collection.
  ;; The package is young and doesn't have comprehensive coverage.
  (use-package tempel-collection)
#+end_src

**** [[https://github.com/emacs-straight/vertico.git][vertico]]
Vertico provides a performant and minimalistic vertical completion UI based on the default completion system.

#+begin_src emacs-lisp
  (use-package vertico
    :custom
    ;; Show more candidates
    (vertico-count 20)

    ;; Grow and shrink the Vertico minibuffer
    (vertico-resize t)

    ;; Optionally enable cycling for `vertico-next' and `vertico-previous'.
    (vertico-cycle t)

    ;; Do not allow the cursor in the minibuffer prompt
    (minibuffer-prompt-properties
     '(read-only t cursor-intangible t face minibuffer-prompt))

    ;; Emacs 28: Hide commands in M-x which do not work in the current mode.
    ;; Vertico commands are hidden in normal buffers.
    (read-extended-command-predicate
     #'command-completion-default-include-p)

    ;; Enable recursive minibuffers
    (enable-recursive-minibuffers t)
    :preface
    ;; Add prompt indicator to `completing-read-multiple'.
    ;; We display [CRM<separator>], e.g., [CRM,] if the separator is a comma.
    (defun crm-indicator (args)
      (cons (format "[CRM%s] %s"
                    (replace-regexp-in-string
                     "\\`\\[.*?]\\*\\|\\[.*?]\\*\\'" ""
                     crm-separator)
                    (car args))
            (cdr args)))
    :config
    (advice-add #'completing-read-multiple :filter-args #'crm-indicator)

    ;; from: https://github.com/SystemCrafters/crafted-emacs/blob/c9ab29592b728954d3acc11d66e76cfbfbcb6189/modules/crafted-completion.el#L43
    ;; Straight and Package bundle the vertico package differently. When
    ;; using `package.el', the extensions are built into the package and
    ;; available on the load-path. When using `straight.el', the
    ;; extensions are not built into the package, so have to add that path
    ;; to the load-path manually to enable the following require.
    (when (fboundp 'straight-use-package)
      (add-to-list 'load-path
                   (expand-file-name "straight/build/vertico/extensions"
                                     straight-base-dir)))
    (require 'vertico-directory)
    :hook
    ((minibuffer-setup . cursor-intangible-mode)
     (after-init . vertico-mode)))
#+end_src

*** Version Control
**** [[https://github.com/emacsorphanage/git-gutter.git][git-gutter]]
#+begin_src emacs-lisp
  (use-package git-gutter
    :custom
    (git-gutter:ask-p . nil)
    (git-gutter:disabled-modes '(fundamental-mode image-mode pdf-view-mode))
    ;;update interval for diff information
    (git-gutter:update-interval 0.5)

    ;; PERF: Only enable the backends that are available, so it doesn't have to
    ;;   check when opening each buffer.
    (git-gutter:handled-backends
     (cons 'git (cl-remove-if-not #'executable-find (list 'hg 'svn 'bzr)
                                  :key #'symbol-name)))
    :config
    ;; (add-hook 'after-focus-change-function #'git-gutter:update-all-windows)
    (use-package git-gutter-fringe
      :demand t
      :config
      (define-fringe-bitmap 'git-gutter-fr:added [224] nil nil '(center repeated))
      (define-fringe-bitmap 'git-gutter-fr:modified [224] nil nil '(center repeated))
      (define-fringe-bitmap 'git-gutter-fr:deleted [128 192 224 240] nil nil 'bottom))
    :bind
    (:repeat-map my/git-gutter-repeat-map
                 ("n" . git-gutter:next-hunk)
                 ("p" . git-gutter:previous-hunk)
                 ("s" . git-gutter:stage-hunk)
                 ("d" . git-gutter:popup-hunk)
                 ("r" . git-gutter:revert-hunk)
                 :exit
                 ("c" . magit-commit-create))
    :hook
    (after-init . global-git-gutter-mode))
#+end_src

**** [[https://codeberg.org/pidu/git-timemachine.git][git-timemachine]]
#+begin_src emacs-lisp
  (use-package git-timemachine
    :bind
    (:map my/version-control-map
          ("t" . git-timemachine)))
#+end_src

**** [[https://github.com/magit/magit.git][magit]]
The magical git client. Let's load magit only when one of the several entry pont
functions we invoke regularly outside of magit is called.

#+begin_src emacs-lisp
  (use-package magit
    :commands (magit-status magit-blame magit-log-buffer-file magit-log-all)
    :bind
    (:map my/version-control-map
          ("F"  . magit-fetch-all)
          ("P"  . magit-push-current)
          ("b"  . magit-branch)
          ("b"  . magit-branch-or-checkout)
          ("c"  . magit-commit)
          ("d"  . magit-diff-unstaged)
          ("f"  . magit-fetch)
          ("la" . magit-log-all)
          ("lc" . magit-log-current)
          ("lf" . magit-log-buffer-file)
          ("p"  . magit-pull-branch)
          ("v"  . magit-status)
          ("r"  . magit-rebase)))
#+end_src
*** Project Management
**** [[https://github.com/fritzgrabo/project-tab-groups.git][project-tab-groups]]
#+begin_src emacs-lisp
  (use-package tab-bar
    :straight nil
    :bind
    (:repeat-map my/workspace-map
                 ("p" . tab-previous)
                 ("n" . tab-next)
                 ("P" . tab-bar-move-tab-backward)
                 ("N". tab-bar-move-tab)
                 :exit
                 ("k" . tab-close-group))
    :custom
    (tab-bar-close-button-show t)
    (tab-bar-format '(tab-bar-format-history tab-bar-format-tabs-groups))
    (tab-bar-separator "")
    (tab-bar-close-button (propertize "×"
                                      'close-tab t
                                      'face 'tab-bar-tab-default
                                      :help "Click to close tab"))
    (tab-bar-auto-width nil)
    :preface
    (defun my/set-tab-faces (&rest r)
      (if (display-graphic-p)
          (let ((bg (face-attribute 'default :background))
                (fg (face-attribute 'default :foreground))
                (base (face-attribute 'mode-line :background))
                (box-width (/ (line-pixel-height) 3)))
            (set-face-attribute 'tab-bar-tab nil :foreground fg :background bg :weight 'normal :inherit nil :box (list :line-width box-width :color bg))
            (set-face-attribute 'tab-bar-tab-inactive nil :foreground fg :background base :weight 'normal :inherit nil :box (list :line-width box-width :color base)))))
    (defun my/tab-bar-tab-name-current-filter-return (str)
      (format " %s " str))
    (advice-add 'tab-bar-tab-name-current :filter-return #'my/tab-bar-tab-name-current-filter-return)

    (defun my/tab-bar-tab-group-default-filter-return (str)
      (format " %s " str))
    (advice-add 'tab-bar-tab-group-default :filter-return #'my/tab-bar-tab-group-default-filter-return)

    (defun my/tab-bar--format-tab-group-around (orig-fun tab i &optional current-p)
      (let ((color (face-attribute (if current-p
                                       'mode-line-emphasis
                                     'tab-bar-tab-group-inactive) :foreground)))
        (append (cons `(,(intern (format "group-sep-%i" i)) menu-item
                        ,(propertize " " 'face (list :height (if current-p 0.3 0.2)
                                                     :foreground color
                                                     :background color))
                        ignore)
                      (funcall orig-fun tab i current-p))
                (when current-p (list`(,(intern (format "group-arrow-%i" i)) menu-item
                                       ,(propertize "⏵" 'face 'tab-bar-tab-group-current)
                                       ignore))))))

    (defun my/setup-tab-bar-mode nil
      (advice-add 'load-theme :after #'my/set-tab-faces)
      (advice-add 'tab-bar--format-tab-group :around #'my/tab-bar--format-tab-group-around)
      (tab-group "")
      (my/set-tab-faces)
      (tab-bar-mode))
    :hook
    (after-init . my/setup-tab-bar-mode))

  (use-package project-tab-groups
    :after tab-bar
    :preface
    ;; We need to update the provided advice for kill project buffers to find
    ;; the tab group with our custom format
    (defun my/project-tab-groups--project-kill-buffers-advice-overwrite (orig-fun &rest args)
      "Call ORIG-FUN with ARGS, then close the current tab group, if any."
      (when (apply orig-fun args)
        (when-let ((tab-group-name (funcall tab-bar-tab-group-function
                                            (tab-bar--current-tab-find))))
          (tab-bar-close-group-tabs tab-group-name))))

    :config
    (if (display-graphic-p)
        (setq tab-group-name-template " %s"))

    (advice-add 'project-tab-groups--project-kill-buffers-advice :override 'my/project-tab-groups--project-kill-buffers-advice-overwrite)

    (with-eval-after-load 'tab-bar-echo-area
      (push #'project-switch-project tab-bar-echo-area-trigger-display-functions)
      (tab-bar-echo-area-apply-display-tab-names-advice))
    :hook (after-init . project-tab-groups-mode))
#+end_src
**** speedbar :build_in:
#+begin_src emacs-lisp
  (use-package speedbar
    :custom
    (speedbar-frame-parameters
     '((name . "speedbar")
       (title . "speedbar")
       (minibuffer . nil)
       (border-width . 2)
       (menu-bar-lines . 0)
       (tool-bar-lines . 0)
       (unsplittable . t)
       (left-fringe . 10)))
    ;; Increase the indentation for better useability.
    (speedbar-indentation-width 3)
    ;; make speedbar update automaticaly, and dont use ugly icons(images)
    (speedbar-update-flag t)
    (speedbar-use-images nil)

    :config
    ;; list of supported file-extensions
    ;; feel free to add to this list
    (speedbar-add-supported-extension
     (list
      ;; lua and fennel(lisp that transpiles to lua)
      ".lua"
      ".fnl"
      ".fennel"
      ;; shellscript
      ".sh"
      ".bash";;is this ever used?
      ;; web languages
      ;; Hyper-Text-markup-language(html) and php
      ".php"
      ".html"
      ".htm"
      ;; ecma(java/type)-script
      ".js"
      ".json"
      ".ts"
      ;; stylasheets
      ".css"
      ".less"
      ".scss"
      ".sass"
      ;; c/c++ and makefiles
      ".c"
      ".cpp"
      ".h"
      "makefile"
      "MAKEFILE"
      "Makefile"
      ;; runs on JVM, java,kotlin etc
      ".java"
      ".kt";;this is for kotlin
      ".mvn"
      ".gradle" ".properties";; this is for gradle-projects
      ".clj";;lisp on the JVM
      ;; lisps
      ".cl"
      ".el"
      ".scm"
      ".lisp"
      ;; configuration
      ".yaml"
      ".toml"
      ;; json is already in this list
      ;; notes,markup and orgmode
      ".md"
      ".markdown"
      ".org"
      ".txt"
      "README"
      ;; Jupyter Notebooks
      ".ipynb"))

    :hook
    ((speedbar-mode . (lambda()
                        ;; Disable word wrapping in speedbar if you always enable it globally.
                        (visual-line-mode 0)
                        ;; Change speedbar's text size.  May need to alter the icon size if you change size.
                        (text-scale-adjust -1)))))
  (use-package sr-speedbar
    :custom
    (sr-speedbar-right-side nil)
    :bind
    (:map my/toggle-map
          ("s" . sr-speedbar-toggle)))

  ;; (use-package pretty-speedbar
  ;;   :demand t
  ;;   :custom
  ;;   (pretty-speedbar-font "Symbols Nerd Font Mono")
  ;;   )
#+end_src

*** Programming
**** [[https://github.com/emacs-straight/auctex.git][auctex]]
#+begin_src emacs-lisp
  (use-package auctex
    :mode ("\\.tex\\'" . latex-mode)
    :commands (latex-mode LaTeX-mode plain-tex-mode)
    :hook
    ((LaTeX-mode-hook . LaTeX-preview-setup)
     (LaTeX-mode-hook . LaTeX-math-mode)
     (LaTeX-mode-hook . flyspell-mode)
     (LaTeX-mode-hook . turn-on-reftex))
    :custom
    (TeX-auto-save t)
    (TeX-parse-self t)
    (TeX-save-query nil)
    (TeX-PDF-mode t))
#+end_src

**** [[https://github.com/mickeynp/combobulate.git][combobulate]]
Structured Editing and Navigation in Emacs
#+begin_src emacs-lisp
  (use-package combobulate
    :after treesit
    :custom
    ;; ;; You can customize Combobulate's key prefix here.
    ;; ;; Note that you may have to restart Emacs for this to take effect!
    (combobulate-key-prefix "C-c o")
    :config
    (define-key my/open-map "c" (cons "combobulate" combobulate-key-map))

    ;; Optional, but recommended.
    ;;
    ;; You can manually enable Combobulate with `M-x
    ;; combobulate-mode'.
    :hook
    ((python-ts-mode . combobulate-mode)
     (js-ts-mode . combobulate-mode)
     (css-ts-mode . combobulate-mode)
     (yaml-ts-mode . combobulate-mode)
     (typescript-ts-mode . combobulate-mode)
     (tsx-ts-mode . combobulate-mode)))
#+end_src
**** docker
#+begin_src emacs-lisp
  (use-package docker
    :commands docker)
  (use-package dockerfile-mode
    :mode "/Dockerfile\\'"
    :mode "/Containerfile\\'"
    :mode "\\.dockerfile\\'"
    :mode "\\.containerfile\\'")
  (use-package tramp-container
    :straight nil
    :after docker)
#+end_src
**** [[https://github.com/emacs-straight/eglot.git][eglot]]
#+begin_src emacs-lisp
  (use-package eglot
    :hook ((python-mode python-ts-mode) . eglot-ensure))
#+end_src

**** [[https://github.com/millejoh/emacs-ipython-notebook][ein]]
#+begin_src emacs-lisp
  (use-package ein
    :mode ("\\.ipynb\\'" . ein:ipynb-mode))
#+end_src

**** [[https://github.com/flycheck/flycheck.git][flycheck]]
#+begin_src emacs-lisp
  (use-package flycheck
    :custom
    ;; Let git gutter have left fringe, flycheck can have right fringe
    (flycheck-indication-mode 'right-fringe)
    :config
    ;; A non-descript, left-pointing arrow
    (define-fringe-bitmap 'flycheck-fringe-bitmap-double-arrow
      [16 48 112 240 112 48 16] nil nil 'center)
    :hook (after-init . global-flycheck-mode))
#+end_src

**** [[https://github.com/emacs-straight/flymake.git][flymake]]
universal on-the-fly syntax checker for Emacs
#+begin_src emacs-lisp
  (use-package flymake
    :custom
    ;; Let git gutter have left fringe, flymake can have right fringe
    (flymake-fringe-indicator-position 'right-fringe))
#+end_src

**** [[https://github.com/lassik/emacs-format-all-the-code.git][format-all]]
#+begin_src emacs-lisp
  (use-package format-all
    ;;:hook (prog-mode . format-all-mode)
    :bind
    (:map my/toggle-map
          ("f" . format-all-buffer)))
#+end_src

**** [[https://github.com/immerrr/lua-mode.git][lua]]
#+begin_src emacs-lisp
  (use-package lua-mode
    :mode "\\.lua\\'")
#+end_src
**** [[https://github.com/jrblevin/markdown-mode.git][markdown]]
#+begin_src emacs-lisp
  (use-package markdown-mode
    :mode "\\.md\\'")
#+end_src
**** [[https://github.com/pythonic-emacs/pythonic.git][python]]
#+begin_src emacs-lisp
  (use-package python
    :mode ("[./]flake8\\'" . conf-mode)
    :mode ("/Pipfile\\'" . conf-mode)
    :mode ("\\.py\\'" . python-mode)
    :interpreter ("python" . python-mode)
    :custom
    ;; Let Emacs guess Python indent silently
    (python-indent-guess-indent-offset t)
    (python-indent-guess-indent-offset-verbose nil)

    :config
    ;; Default to Python 3. Prefer the versioned Python binaries since some
    ;; systems link the unversioned one to Python 2.
    (when (and (executable-find "python3")
               (string= python-shell-interpreter "python"))
      (setq python-shell-interpreter "python3")))

  (use-package conda
    :after python
    :custom
    ;; support for mambaforge envs
    (conda-anaconda-home "~/mambaforge/")
    (conda-env-home-directory "~/mambaforge/")
    :config
    ;; interactive shell support
    (conda-env-initialize-interactive-shells)
    ;; if you want eshell support, include:
    (conda-env-initialize-eshell)
    (conda-env-activate "dev310")
    ;; enable auto-activation
    ;; (conda-env-autoactivate-mode t)
    ;; if you want to automatically activate a conda environment on the opening of a file:
    ;; (add-to-hook 'find-file-hook (lambda () (when (bound-and-true-p conda-project-env-path)
    ;;                       (conda-env-activate-for-buffer))))
    )

  (use-package numpydoc
    :after python)

  (use-package pyimport
    :after conda)

  (use-package py-isort
    :after conda)
#+end_src

**** [[https://github.com/renzmann/treesit-auto.git][treesit-auto]]
built-in tree-sitter integration for Emacs
#+begin_src emacs-lisp
  (use-package treesit-auto
    :if (>= emacs-major-version 29)
    :custom
    (treesit-auto-install 'prompt)
    :hook
    (after-init . global-treesit-auto-mode))
#+end_src

**** [[https://github.com/yoshiki/yaml-mode.git][yaml]]
#+begin_src emacs-lisp
  (use-package yaml-mode
    :mode "\\.ya?ml\\'")
#+end_src
*** Keybindings
**** [[https://github.com/meow-edit/meow.git][meow]]
Meow is yet another modal editing mode for Emacs.
#+begin_src emacs-lisp
  (use-package meow
    :demand t
    :custom
    (meow-keypad-start-keys . ())
    (meow-keypad-meta-prefix . nil)
    (meow-keypad-ctrl-meta-prefix . nil)
    (meow-keypad-literal-prefix . nil)
    ;; (meow-keypad-self-insert-undefined . nil)
    ;; use system clipboard
    (meow-use-clipboard t)
    (meow-cheatsheet-layout meow-cheatsheet-layout-qwerty)

    :preface
    ;; Buffer-local variable to specify the desired Meow state
    (defvar my/meow-desired-state nil
      "Buffer-local variable to specify the desired Meow state.")

    ;; Function to set the buffer-local value of my/meow-desired-state
    (defun my/meow-set-desired-state (state)
      "Set the buffer-local variable =my/meow-desired-state= to the specified state."
      (setq-local my/meow-desired-state state))

    ;; Advice function to modify 'meow--mode-get-state' based on 'my/meow-desired-state'
    (defun my/meow-mode-get-state-advice (orig-func &rest args)
      "Advice function to modify =meow--mode-get-state= based
    on =my/meow-desired-state=."
      (if my/meow-desired-state
          my/meow-desired-state
        (apply orig-func args)))

    ;; Hook to set my/meow-desired-state to 'motion' when entering git-timemachine mode
    (defun my/meow-git-timemachine-hook ()
      "Hook to set my/meow-desired-state to =motion=
  when entering git-timemachine mode."
      (my/meow-set-desired-state 'motion))

    :config
    ;; Apply advice to 'meow--mode-get-state'
    (advice-add 'meow--mode-get-state :around #'my/meow-mode-get-state-advice)
    (add-to-list 'meow-keymap-alist `(leader . ,my/leader-map))
    :bind
    (:map meow-motion-state-keymap
          ("j" . meow-next)
          ("k" . meow-prev)
          ("<escape>" . ignore)
          :map my/leader-map
          ;; ("j" . "H-j")
          ;; ("k" . "H-k")
          ;; ("x" ("C-x" . ctl-x-map))
          ;;("m" . (lambda ()(meow--execute-kbd-macro "C-c")))
          ;; Use SPC (0-9) for digit arguments.
          ("1" . meow-digit-argument)
          ("2" . meow-digit-argument)
          ("3" . meow-digit-argument)
          ("4" . meow-digit-argument)
          ("5" . meow-digit-argument)
          ("6" . meow-digit-argument)
          ("7" . meow-digit-argument)
          ("8" . meow-digit-argument)
          ("9" . meow-digit-argument)
          ("0" . meow-digit-argument)
          ("/" . meow-keypad-describe-key)
          ("?" . meow-cheatsheet)
          :map meow-normal-state-keymap
          ("0" . meow-expand-0)
          ("9" . meow-expand-9)
          ("8" . meow-expand-8)
          ("7" . meow-expand-7)
          ("6" . meow-expand-6)
          ("5" . meow-expand-5)
          ("4" . meow-expand-4)
          ("3" . meow-expand-3)
          ("2" . meow-expand-2)
          ("1" . meow-expand-1)
          ("-" . negative-argument)
          (";" . meow-reverse)
          ("," . meow-inner-of-thing)
          ("." . meow-bounds-of-thing)
          ("[" . meow-beginning-of-thing)
          ("]" . meow-end-of-thing)
          ("a" . meow-append)
          ("A" . meow-open-below)
          ("b" . meow-back-word)
          ("B" . meow-back-symbol)
          ("c" . meow-change)
          ("C" . meow-comment)
          ("d" . meow-delete)
          ("D" . meow-backward-delete)
          ("e" . meow-next-word)
          ("E" . meow-next-symbol)
          ("f" . meow-find)
          ("<escape>" . meow-cancel-selection)
          ("G" . meow-grab)
          ("h" . meow-left)
          ("H" . meow-left-expand)
          ("i" . meow-insert)
          ("I" . meow-open-above)
          ("j" . meow-next)
          ("J" . meow-next-expand)
          ("k" . meow-prev)
          ("K" . meow-prev-expand)
          ("l" . meow-right)
          ("L" . meow-right-expand)
          ("m" . meow-join)
          ("n" . meow-search)
          ("o" . meow-block)
          ("O" . meow-to-block)
          ("p" . meow-yank)
          ("q" . meow-quit)
          ("Q" . meow-goto-line)
          ("r" . meow-replace)
          ("R" . undo-redo)
          ("s" . meow-kill)
          ("t" . meow-till)
          ("u" . meow-undo)
          ("U" . meow-undo-in-selection)
          ("v" . meow-visit)
          ("w" . meow-mark-word)
          ("W" . meow-mark-symbol)
          ("x" . meow-line)
          ("X" . meow-goto-line)
          ("y" . meow-save)
          ("Y" . meow-sync-grab)
          ("z" . meow-pop-selection)
          ("=" . meow-indent)
          ("'" . repeat))
    :hook
    ((git-timemachine-mode . my/meow-git-timemachine-hook)
     (after-init . meow-global-mode)))
#+end_src

**** [[https://github.com/justbur/emacs-which-key.git][which-key]]
The mode displays the key bindings following your currently entered incomplete command (a ;; prefix) in a popup.
#+begin_src emacs-lisp
  (use-package which-key
    :after meow emacs
    :defer 0.1
    :custom
    (which-key-idle-delay 0.1)
    :config
    (which-key-mode))
#+end_src

** Conventional Library Footer
#+begin_src emacs-lisp
  (provide 'emacs.el)
  ;;; emacs.el ends here
#+end_src
